#课堂题

## 小组思考题

#### 请参考lab3_result的代码，思考如何在lab3_results中实现clock算法，给出你的概要设计方案。可4人一个小组。要求说明你的方案中clock算法与LRU算法上相比，潜在的性能差异性。进而说明在lab3的LRU算法实现的可能性评价（给出理由）。

###### 设计方案

在swap.c的第41行有如下代码，将swap_manager_fifo替换为swap_manager_clock，即可在lab3中实现自定义的clock算法。

```
sm = &swap_manager_fifo;
```

clock算法的实现与FIFO类似，需要修改的内容如下。

- init_mm()接口中，将初始的双向链表设置为环状，页面访问位置零，并增加一个时钟指针，指向最先调入的页面。
- swap_out_victim()接口中，扫描双向链表，当且仅当时钟指针指向的页面访问位为0时，当前页面即为将要被替换的victim页面，则返回当前页面。否则该页的访问位为1，则置当前页访问位为0，将时钟指针指向双向链表中下一个页面，重复上述操作。

当访问某一个页面时，CPU会自动把访问位置为1，操作系统无需做任何处理，而访问位置零操作则需要由操作系统来完成。

###### 性能差异性

- clock算法是LRU算法和FIFO算法的折中，它仅对页面的访问情况作大致统计，并且页面置换时无需修改链表的结构，因此时间开销比LRU算法低。
- clock算法对页面的访问情况不如LRU算法精确，因此通常表现不如LRU算法。

###### 实现LRU算法

可以通过维护页面链表或活动页面栈来实现LRU算法，但是开销比较大。
